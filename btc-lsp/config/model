-- Syntax for this file here:
-- https://github.com/yesodweb/persistent/blob/master/docs/Persistent-entity-syntax.md

User
  nodePubKey NodePubKey
  latestNonce Nonce
  insertedAt UTCTime
  updatedAt UTCTime
  UniqueUser nodePubKey
  deriving Eq Show Generic

LnChan
  userId UserId
  fundingTxId (TxId 'Funding)
  fundingVout (Vout 'Funding)
  closingTxId (TxId 'Closing) Maybe
  numUpdates Word64
  status LnChanStatus
  insertedAt UTCTime
  updatedAt UTCTime
  UniqueLnChan fundingTxId fundingVout
  deriving Eq Show Generic

SwapIntoLn
  userId UserId
  -- Nonce is client-side reference
  nonce Nonce
  fundInvoice (LnInvoice 'Fund)
  fundAddress (OnChainAddress 'Fund)
  refundAddress (OnChainAddress 'Refund)
  chanCapUser (Money 'Customer 'Ln 'Fund)
  chanCapLsp (Money 'Lsp 'Ln 'Fund)
  feeLsp (Money 'Lsp 'OnChain 'Gain)
  feeMiner (Money 'Lsp 'OnChain 'Loss)
  status SwapStatus
  expiresAt UTCTime
  insertedAt UTCTime
  updatedAt UTCTime
  UniqueSwapIntoLnFundInvoice fundInvoice
  UniqueSwapIntoLnFundAddress fundAddress
  deriving Eq Show Generic
